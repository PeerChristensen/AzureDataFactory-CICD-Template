# Azure Data factory deployment

## Description

This repo functions as a template and contains code for deploying a Data Factory along with pipelines, triggers etc. to a different environment, e.g. a production environment. Commits to the main branch trigger a deployment to the production environment, but only if the ARM-template for the Data Factory contains changes. The workflow may also be triggered manually.

## CI/CD Pipeline Overview

This repo may be cloned and then connected to an existing Data Factory via the Azure Portal. When configuring the GIT integration, you have to set 'main' as the working and release branch. This way, the main branch is always up to date with respect to the current release. 

Importantly, only the Data Factory used for development should be connected to a GIT repo. The production Data Factory is 'read-only' and managed exclusively by means of templates generated by changes to the development Data Factory.

## Prerequisites

- Access to the Azure Portal with permission to create resources.
- A GitHub account
- A Self-Hosted Integration Runtime installed to copy local data (if needed)
- Azure CLI installed (optional, if using a local command prompt to interact with Azure).

## Instructions

1. Modify workflow.yml

Set the below environment variables to match your Azure resources. Note that `ARMTEMPLATEFOLDER_NAME` is the same as the name of your development Data Factory.

```
env:
    RESOURCEGROUP_NAME: adf-iac-prod
    DATAFACTORY_NAME: adf-iac-prod
    ARMTEMPLATEFOLDER_NAME: adf-iac-dev
```

2. Allow GitHub to access and change your production environment

Using the Azure



## Useful Links
- [Installing Azure CLI](https://learn.microsoft.com/en-us/cli/azure/install-azure-cli)
- [Create and configure a self-hosted integration runtime]('https://learn.microsoft.com/en-us/azure/data-factory/create-self-hosted-integration-runtime?tabs=data-factory')
- [Create a shared self-hosted integration runtime in Azure Data Factory]('https://learn.microsoft.com/en-us/azure/data-factory/create-shared-self-hosted-integration-runtime-powershell?source=recommendations#create-a-shared-self-hosted-integration-runtime-in-azure-data-factory-1')
